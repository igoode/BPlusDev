<apex:page standardController="Business__c"
        extensions="BPEmployerExtension"
        sidebar="false" 
        standardStylesheets="false" 
        showHeader="false"
        docType="html-5.0">
    <apex:variable value="{!Business__c}" var="bus" />
    <div id="wrapper">
        <apex:composition template="BPTemplate" />
        <script>        
            $j(function() {
                $j("#tabs").tabs();
            });
        </script>
        <style>
            table.detailList table caption
            {
                margin-top:0 !important;
            }
        </style>
        <apex:form >
            <div class="end-inner end-contacts">
                <c:BPNavBar />       
                <div class="subsection end-banner">
                     <apex:image value="{!URLFOR($Resource.EndiceResources, 'banner.jpg')}"/>
                </div>
                <div id="content">
                    <div class="end-contact"> 
                        <apex:sectionHeader title="Employer Details" />         
                        <apex:pageBlock >
                            <div class="end-contact-block end-contact-seeker">
                                <apex:pageblockSection columns="1">
                                    <apex:outputfield value="{!bus.Name}"/>  
                                    <apex:outputfield value="{!bus.Location__c}"/> 
                                    <apex:outputfield value="{!bus.Last_Contacted__c}"/>
                                    <apex:outputfield value="{!bus.Last_Contacted_By__r.Name}" label="Last Contacted By"/>
                                    <apex:outputfield value="{!bus.Do_Not_Disturb_Expiry__c}"/>
                                </apex:pageblockSection>  
                            </div>
                            <apex:pageBlockButtons location="bottom">
                                <apex:commandButton value="Update / New Referral " action="{!newContact}" styleClass="btn"/>
                            </apex:pageBlockButtons> 
                        </apex:pageBlock>
                        <div class="end-job-seeker-tools">
                            <apex:pageBlock >
                                <div id="tabs">
                                    <ul>
                                        <li><a href="#tabs-1">Employer Contacts</a></li>
                                        <li><a href="#tabs-2">Followups</a></li>
                                        <li><a href="#tabs-3">Wage Subsidies</a></li>
                                    </ul>
                                    <div id="tabs-1" class="end-job-seeker-tools">
                                        <apex:pageBlockSection columns="1">
                                            <apex:pageBlockTable value="{!EmployerContacts}" 
                                                    var="ec" >
                                                <apex:facet name="caption">
                                                    Employer Contacts 
                                                </apex:facet>
                                                <apex:column value="{!ec.Contacted_On__c}" headerValue="Contacted On" onclick="goPage('{!ec.ID}');"/>
                                                <apex:column value="{!ec.Job_Seeker__c}"  onclick="goPage('{!ec.ID}');"/>
                                                <apex:column value="{!ec.User__r.Name}" headerValue="Contacted By" onclick="goPage('{!ec.ID}');"/>
                                                <apex:column value="{!ec.Result__c}" headerValue="Result" onclick="goPage('{!ec.ID}');"/>
                                                <apex:column value="{!ec.Interview_Date__c} {!ec.Interview_Time__c}" headerValue="Date" onclick="goPage('{!ec.ID}');"/>
                                                <apex:column value="{!ec.Comment__c}" width="50%" onclick="goPage('{!ec.ID}');"/>
                                            </apex:pageBlockTable>   
                                        </apex:pageBlockSection>
                                    </div>
                                    <div id="tabs-2">
                                        <apex:pageBlockSection columns="1">
                                            <apex:pageBlockTable value="{!Followups}" 
                                                    var="fu"  >
                                                <apex:facet name="caption">
                                                    Followups 
                                                </apex:facet>
                                                <apex:column value="{!fu.Due_Date__c} {!fu.Due_Time__c}" headerValue="Due" onclick="goPage('{!fu.ID}');"/>
                                                <apex:column value="{!fu.Job_Seeker__c}"  onclick="goPage('{!fu.ID}');"/>
                                                <apex:column value="{!fu.Assigned_To__r.Name}"  onclick="goPage('{!fu.ID}');"/>
                                                <apex:column value="{!fu.Employer_Contact__c}"  onclick="goPage('{!fu.ID}');"/>
                                                <apex:column value="{!fu.Type__c}"  onclick="goPage('{!fu.ID}');"/>
                                                <apex:column value="{!fu.Actioned__c}"  onclick="goPage('{!fu.ID}');"/>
                                                <apex:column value="{!fu.Action_Taken__c}"  onclick="goPage('{!fu.ID}');"/>      
                                                <apex:column value="{!fu.Comment__c}" width="50%"  onclick="goPage('{!fu.ID}');"/>
                                            </apex:pageBlockTable>   
                                        </apex:pageBlockSection>
                                    </div>
                                    <div id="tabs-3">
                                        <apex:pageBlockSection columns="1">
                                            <apex:pageBlockTable value="{!Subsidies}" 
                                                    var="su" >
                                                <apex:facet name="caption">
                                                    Wage Subsidies 
                                                </apex:facet>
                                                <apex:column value="{!su.Job_Seeker__c}"  onclick="goPage('{!su.ID}');"/>
                                                <apex:column value="{!su.EC__r.Name}" headerValue="Sent By" onclick="goPage('{!su.ID}');"/>
                                                <apex:column headerValue="Subsidy"  onclick="goPage('{!su.ID}');">
                                                    <apex:repeat value="{!su.Attachments}" var="att">
                                                        <apex:outputLink value="{!URLFOR($Action.Attachment.Download, att.ID)}">
                                                            View
                                                        </apex:outputLink>
                                                    </apex:repeat>
                                                </apex:column>
                                            </apex:pageBlockTable>   
                                        </apex:pageBlockSection>
                                    </div>
                                </div>
                            </apex:pageBlock>
                        </div>
                    </div>
                </div>
            </div>
        </apex:form>        
        <apex:composition template="BPFooter" />
     </div>   
</apex:page>